

<K_PROGRAM> <IDENTIFIER,$two_grid_solver>
<LCURLY>

            
    <K_PROCEDURE>
         <IDENTIFIER,set_constant><LPAREN>
            <K_DOUBLE>  <IDENTIFIER,dval><COMMA>                               <K_DOUBLE>  <IDENTIFIER,dsoln><LBRACKET><RBRACKET><COMMA> <K_INTEGER> <IDENTIFIER,s1>                          <RPAREN>
    <LCURLY>
        <K_INTEGER> <IDENTIFIER,i> <ASSIGN> <ICONSTANT,0><SEMI>                     
        <K_DO> <K_WHILE> <LPAREN> <IDENTIFIER,i> <GEQ> <ICONSTANT,0> <DAND> <IDENTIFIER,i> <LEQ> <IDENTIFIER,s1> <RPAREN>
            <IDENTIFIER,dsoln><LBRACKET><IDENTIFIER,i><INCREMENT><RBRACKET> <ASSIGN> <IDENTIFIER,dval><SEMI>

    <RCURLY>   

            
    <K_PROCEDURE>
         <IDENTIFIER,print_vector><LPAREN>
            <K_STRING>  <IDENTIFIER,title><COMMA>                              <K_DOUBLE>  <IDENTIFIER,dsoln><LBRACKET><RBRACKET><COMMA> <K_INTEGER> <IDENTIFIER,s1>                          <RPAREN>
    <LCURLY>
        <K_INTEGER> <IDENTIFIER,i><SEMI>

        <K_PRINT_STRING><LPAREN> <SCONSTANT,"Vector: "> <RPAREN><SEMI>
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"title"> <RPAREN><SEMI>
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"\ni  value\n"> <RPAREN><SEMI>
        <K_DO> <LPAREN> <IDENTIFIER,i> <ASSIGN> <ICONSTANT,0><SEMI> <IDENTIFIER,i> <LEQ> <IDENTIFIER,s1><SEMI> <IDENTIFIER,i><INCREMENT> <RPAREN>
        <LCURLY>
            <K_PRINT_INTEGER><LPAREN> <IDENTIFIER,i> <RPAREN><SEMI>
            <K_PRINT_STRING><LPAREN> <SCONSTANT," "> <RPAREN><SEMI>
            <K_PRINT_DOUBLE><LPAREN> <IDENTIFIER,dsoln><LBRACKET><IDENTIFIER,i><RBRACKET> <RPAREN><SEMI>
        <RCURLY>   
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"--- End of vector\n"> <RPAREN><SEMI>

    <RCURLY>   

            
    <K_FUNCTION>
    <K_DOUBLE> <IDENTIFIER,error_norm><LPAREN>
            <K_DOUBLE>  <IDENTIFIER,dsoln><LBRACKET><RBRACKET><COMMA> <K_INTEGER> <IDENTIFIER,s1>                              <RPAREN>
    <LCURLY>
        <K_INTEGER> <IDENTIFIER,i> <ASSIGN> <ICONSTANT,0><SEMI>                         <K_DOUBLE>  <IDENTIFIER,asoln><SEMI>                          <K_DOUBLE>  <IDENTIFIER,l0_norm> <ASSIGN> <DCONSTANT,0.0d0><SEMI>       
                
        <K_DO> <K_UNTIL> <LPAREN> <IDENTIFIER,i> <GT> <IDENTIFIER,s1> <RPAREN>
        <LCURLY>
            <K_IF> <LPAREN> <IDENTIFIER,dsoln><LBRACKET><IDENTIFIER,i><RBRACKET> <LEQ> <DCONSTANT,0.> <RPAREN> <K_THEN>
                <IDENTIFIER,asoln> <ASSIGN> <MINUS><IDENTIFIER,dsoln><LBRACKET><IDENTIFIER,i><RBRACKET><SEMI>
            <K_ELSE>
                <IDENTIFIER,asoln> <ASSIGN> <IDENTIFIER,dsoln><LBRACKET><IDENTIFIER,i><RBRACKET><SEMI>
            <K_IF> <LPAREN> <IDENTIFIER,asoln> <GT> <IDENTIFIER,l0_norm> <RPAREN> <K_THEN>
            <LCURLY>
                <IDENTIFIER,l0_norm> <ASSIGN> <IDENTIFIER,asoln><SEMI>
            <RCURLY>   
            <IDENTIFIER,i><INCREMENT><SEMI>
        <RCURLY>   

        <K_RETURN> <IDENTIFIER,l0_norm><SEMI>

    <RCURLY>   

            
    <K_PROCEDURE>
         <IDENTIFIER,residuals><LPAREN>
            <K_DOUBLE>  <IDENTIFIER,dsoln><LBRACKET><RBRACKET><COMMA> <K_INTEGER> <IDENTIFIER,s1><COMMA>                    <K_DOUBLE>  <IDENTIFIER,drhs><LBRACKET><RBRACKET><COMMA> <K_INTEGER> <IDENTIFIER,rhs1><COMMA>                   <K_DOUBLE>  <IDENTIFIER,dres><LBRACKET><RBRACKET><COMMA> <K_INTEGER> <IDENTIFIER,res1>                           <RPAREN>
    <LCURLY>
        <K_INTEGER> <IDENTIFIER,i><SEMI>                      
                <IDENTIFIER,dres><LBRACKET><ICONSTANT,0><RBRACKET> <ASSIGN> <IDENTIFIER,dres><LBRACKET><IDENTIFIER,res1><RBRACKET> <ASSIGN> <DCONSTANT,0.0d0><SEMI>
        <K_DO> <LPAREN> <IDENTIFIER,i> <ASSIGN> <ICONSTANT,1><SEMI> <IDENTIFIER,i> <LT> <IDENTIFIER,s1><SEMI> <IDENTIFIER,i><INCREMENT> <RPAREN>
            <IDENTIFIER,dres><LBRACKET><IDENTIFIER,i><RBRACKET> <ASSIGN> <IDENTIFIER,drhs><LBRACKET><IDENTIFIER,i><RBRACKET> <MINUS> <DCONSTANT,2.0> <MULTIPLY> <IDENTIFIER,dsoln><LBRACKET><IDENTIFIER,i><RBRACKET> 
                              <PLUS> <IDENTIFIER,dsoln><LBRACKET><IDENTIFIER,i><MINUS><ICONSTANT,1><RBRACKET> 
                              <PLUS> <IDENTIFIER,dsoln><LBRACKET><IDENTIFIER,i><PLUS><ICONSTANT,1><RBRACKET><SEMI>

    <RCURLY>   

            
    <K_FUNCTION>
    <K_DOUBLE> <IDENTIFIER,gauss_seidel><LPAREN>
            <K_INTEGER> <IDENTIFIER,iters><COMMA>                                  <K_DOUBLE>  <IDENTIFIER,dsoln><LBRACKET><RBRACKET><COMMA> <K_INTEGER> <IDENTIFIER,s1><COMMA>                    <K_DOUBLE>  <IDENTIFIER,drhs><LBRACKET><RBRACKET><COMMA> <K_INTEGER> <IDENTIFIER,rhs1>                             <RPAREN>
    <LCURLY>
        <K_INTEGER> <IDENTIFIER,i><COMMA> <IDENTIFIER,n><ASSIGN><ICONSTANT,1><SEMI>                        
                <K_DO> <K_UNTIL> <LPAREN> <IDENTIFIER,n> <GT> <IDENTIFIER,iters> <RPAREN>
        <LCURLY>
            <K_DO> <LPAREN> <IDENTIFIER,i> <ASSIGN> <ICONSTANT,1><SEMI> <IDENTIFIER,i> <LT> <IDENTIFIER,s1><SEMI> <IDENTIFIER,i><INCREMENT> <RPAREN>
                <IDENTIFIER,dsoln><LBRACKET><IDENTIFIER,i><RBRACKET> <ASSIGN> <LPAREN> <IDENTIFIER,drhs><LBRACKET><IDENTIFIER,i><RBRACKET> <PLUS> <IDENTIFIER,dsoln><LBRACKET><IDENTIFIER,i><MINUS><ICONSTANT,1><RBRACKET> 
                                     <PLUS> <IDENTIFIER,dsoln><LBRACKET><IDENTIFIER,i><PLUS><ICONSTANT,1><RBRACKET><RPAREN> <DIVIDE> <DCONSTANT,2.0d0><SEMI>
            <IDENTIFIER,n><INCREMENT><SEMI>
        <RCURLY>   

                <K_RETURN> <IDENTIFIER,error_norm><LPAREN> <IDENTIFIER,dsoln><COMMA> <IDENTIFIER,s1> <RPAREN><SEMI>

    <RCURLY>   

            
    <K_FUNCTION>
    <K_INTEGER> <IDENTIFIER,interpolate><LPAREN> 
            <K_DOUBLE> <IDENTIFIER,dfrom><LBRACKET><RBRACKET><COMMA> <K_INTEGER> <IDENTIFIER,f1><COMMA>                     <K_DOUBLE> <IDENTIFIER,dto><LBRACKET><RBRACKET><COMMA>   <K_INTEGER> <IDENTIFIER,t1>                             <RPAREN>
    <LCURLY>

        
                        
        <K_PROCEDURE>
             <IDENTIFIER,coarsen><LPAREN> 
                <K_DOUBLE> <IDENTIFIER,dfrom><LBRACKET><RBRACKET><COMMA> <K_INTEGER> <IDENTIFIER,f1><COMMA>                     <K_DOUBLE> <IDENTIFIER,dto><LBRACKET><RBRACKET><COMMA>   <K_INTEGER> <IDENTIFIER,t1>                         <RPAREN>
        <LCURLY>
            <K_INTEGER> <IDENTIFIER,i><COMMA> <IDENTIFIER,m><SEMI>       
                        <IDENTIFIER,dto><LBRACKET><ICONSTANT,0><RBRACKET> <ASSIGN> <IDENTIFIER,dto><LBRACKET><IDENTIFIER,t1><RBRACKET> <ASSIGN> <DCONSTANT,0.><SEMI>
            <IDENTIFIER,m> <ASSIGN> <ICONSTANT,0><SEMI>
            <K_DO> <LPAREN> <IDENTIFIER,i> <ASSIGN> <ICONSTANT,1> <SEMI> <IDENTIFIER,i> <LT> <IDENTIFIER,t1> <SEMI> <IDENTIFIER,i><INCREMENT> <RPAREN>
            <LCURLY>
                <IDENTIFIER,m> <ASSIGN_PLUS> <ICONSTANT,2><SEMI>
                <IDENTIFIER,dto><LBRACKET><IDENTIFIER,i><RBRACKET> <ASSIGN> <IDENTIFIER,dfrom><LBRACKET><IDENTIFIER,m><RBRACKET> <PLUS>
                        <DCONSTANT,5.d-1> <MULTIPLY> <LPAREN> <IDENTIFIER,dfrom><LBRACKET><IDENTIFIER,m><MINUS><ICONSTANT,1><RBRACKET> <PLUS> <IDENTIFIER,dfrom><LBRACKET><IDENTIFIER,m><PLUS><ICONSTANT,1><RBRACKET> <RPAREN><SEMI>
            <RCURLY>   

        <RCURLY>   

                                
        <K_PROCEDURE>
             <IDENTIFIER,refine_add><LPAREN>
                <K_DOUBLE> <IDENTIFIER,dfrom><LBRACKET><RBRACKET><COMMA> <K_INTEGER> <IDENTIFIER,f1><COMMA>                     <K_DOUBLE> <IDENTIFIER,dto><LBRACKET><RBRACKET><COMMA>   <K_INTEGER> <IDENTIFIER,t1>                         <RPAREN>
        <LCURLY>
            <K_INTEGER> <IDENTIFIER,i><COMMA> <IDENTIFIER,m><SEMI>       
                        <IDENTIFIER,m> <ASSIGN> <ICONSTANT,0><SEMI>
            <K_DO> <LPAREN> <IDENTIFIER,i> <ASSIGN> <ICONSTANT,1><SEMI> <IDENTIFIER,i> <LT> <IDENTIFIER,f1> <SEMI> <IDENTIFIER,i><INCREMENT> <RPAREN>
            <LCURLY>
                <IDENTIFIER,m> <ASSIGN> <IDENTIFIER,m> <PLUS> <ICONSTANT,2><SEMI>
                <IDENTIFIER,dto><LBRACKET><IDENTIFIER,m><RBRACKET> <ASSIGN> <IDENTIFIER,dto><LBRACKET><IDENTIFIER,m><RBRACKET> <PLUS> <IDENTIFIER,dfrom><LBRACKET><IDENTIFIER,i><RBRACKET><SEMI>
            <RCURLY>   

                        <IDENTIFIER,m> <ASSIGN> <MINUS><ICONSTANT,1><SEMI>
            <K_DO> <LPAREN> <IDENTIFIER,i> <ASSIGN> <ICONSTANT,0><SEMI> <IDENTIFIER,i> <LT> <IDENTIFIER,f1><SEMI> <IDENTIFIER,i><INCREMENT> <RPAREN>
            <LCURLY>
                <IDENTIFIER,m> <ASSIGN> <IDENTIFIER,m> <PLUS> <ICONSTANT,2><SEMI>
                <IDENTIFIER,dto><LBRACKET><IDENTIFIER,m><RBRACKET> <ASSIGN> <IDENTIFIER,dto><LBRACKET><IDENTIFIER,m><RBRACKET> <PLUS> 
                         <DCONSTANT,.5> <MULTIPLY> <LPAREN> <IDENTIFIER,dfrom><LBRACKET><IDENTIFIER,i><RBRACKET> <PLUS> <IDENTIFIER,dfrom><LBRACKET><IDENTIFIER,i><PLUS><ICONSTANT,1><RBRACKET> <RPAREN><SEMI>
            <RCURLY>   

        <RCURLY>   

        
                <K_IF> <LPAREN> <IDENTIFIER,t1> <DEQ> <IDENTIFIER,f1> <DIVIDE> <ICONSTANT,2> <RPAREN> <K_THEN>
            <IDENTIFIER,coarsen><LPAREN> <IDENTIFIER,dfrom><COMMA> <IDENTIFIER,f1><COMMA> <IDENTIFIER,dto><COMMA> <IDENTIFIER,t1> <RPAREN><SEMI>

                <K_ELSE> <K_IF> <LPAREN> <IDENTIFIER,t1> <DEQ> <IDENTIFIER,f1> <MULTIPLY> <ICONSTANT,2> <RPAREN> <K_THEN>
        <LCURLY>
            <IDENTIFIER,refine_add><LPAREN> <IDENTIFIER,dfrom><COMMA> <IDENTIFIER,f1><COMMA> <IDENTIFIER,dto><COMMA> <IDENTIFIER,t1> <RPAREN><SEMI>
        <RCURLY>   

                <K_ELSE>
        <LCURLY>
            <K_PRINT_STRING><LPAREN> <SCONSTANT,"Error in routine interp: data size mismatch.\n"> <RPAREN><SEMI>
            <K_RETURN> <ICONSTANT,0><SEMI>
        <RCURLY>   
        <K_RETURN> <ICONSTANT,1><SEMI>

    <RCURLY>   

            
    <K_FUNCTION>
    <K_INTEGER> <IDENTIFIER,main><LPAREN> 
            <RPAREN>
    <LCURLY>
        <K_INTEGER> <IDENTIFIER,rval> <ASSIGN> <ICONSTANT,0><SEMI>              <K_INTEGER> <IDENTIFIER,fm1><ASSIGN><ICONSTANT,1><COMMA> <IDENTIFIER,cm1><SEMI>            <K_DOUBLE>  <IDENTIFIER,enorm><SEMI>          
                <K_DO> <K_WHILE><LPAREN> <IDENTIFIER,fm1> <LEQ> <ICONSTANT,4> <DOR> <IDENTIFIER,fm1> <MOD> <ICONSTANT,2> <NE> <ICONSTANT,0> <RPAREN>
        <LCURLY>
            <K_PRINT_STRING><LPAREN> <SCONSTANT,"Number of points in the fine mesh (must be even and atleast 6) "> <RPAREN><SEMI>
            <K_READ_INTEGER><LPAREN> <IDENTIFIER,fm1> <RPAREN><SEMI>
        <RCURLY>   
        <IDENTIFIER,cm1> <ASSIGN> <IDENTIFIER,fm1> <DIVIDE> <ICONSTANT,2><SEMI>
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"Fine   mesh points 0:"> <RPAREN><SEMI>
        <K_PRINT_INTEGER><LPAREN> <IDENTIFIER,fm1> <RPAREN><SEMI>
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"\nCoarse mesh points 0:"> <RPAREN><SEMI>
        <K_PRINT_INTEGER><LPAREN> <IDENTIFIER,cm1> <RPAREN><SEMI>
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"\n"> <RPAREN><SEMI>

                <K_DOUBLE> <IDENTIFIER,fm><LBRACKET><IDENTIFIER,fm1><PLUS><ICONSTANT,1><RBRACKET><COMMA>                      <IDENTIFIER,frhs><LBRACKET><IDENTIFIER,fm1><PLUS><ICONSTANT,1><RBRACKET><COMMA>                    <IDENTIFIER,fres><LBRACKET><IDENTIFIER,fm1><PLUS><ICONSTANT,1><RBRACKET><SEMI>             <K_DOUBLE> <IDENTIFIER,cm><LBRACKET><IDENTIFIER,cm1><PLUS><ICONSTANT,1><RBRACKET><COMMA> <IDENTIFIER,crhs><LBRACKET><IDENTIFIER,cm1><PLUS><ICONSTANT,1><RBRACKET><SEMI>                                          
                <IDENTIFIER,set_constant><LPAREN> <DCONSTANT,1.0d0><COMMA> <IDENTIFIER,fm><COMMA> <IDENTIFIER,fm1> <RPAREN><SEMI>
        <IDENTIFIER,fm><LBRACKET><ICONSTANT,0><RBRACKET> <ASSIGN> <DCONSTANT,0.0d0><SEMI>
        <IDENTIFIER,fm><LBRACKET><IDENTIFIER,fm1><RBRACKET> <ASSIGN> <DCONSTANT,0.><SEMI>
        <IDENTIFIER,print_vector><LPAREN> <SCONSTANT,"Initial guess"><COMMA> <IDENTIFIER,fm><COMMA> <IDENTIFIER,fm1> <RPAREN><SEMI>

                <IDENTIFIER,enorm> <ASSIGN> <IDENTIFIER,error_norm><LPAREN> <IDENTIFIER,fm><COMMA> <IDENTIFIER,fm1> <RPAREN><SEMI>
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"initial error norm := "> <RPAREN><SEMI>
        <K_PRINT_DOUBLE><LPAREN> <IDENTIFIER,enorm> <RPAREN><SEMI>
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"\n"> <RPAREN><SEMI>

                <IDENTIFIER,enorm> <ASSIGN> <IDENTIFIER,gauss_seidel><LPAREN> <ICONSTANT,4><COMMA> <IDENTIFIER,fm><COMMA> <IDENTIFIER,fm1><COMMA> <IDENTIFIER,frhs><COMMA> <IDENTIFIER,fm1> <RPAREN><SEMI>
        <IDENTIFIER,print_vector><LPAREN> <SCONSTANT,"after first fine mesh smoothing"><COMMA> <IDENTIFIER,fm><COMMA> <IDENTIFIER,fm1> <RPAREN><SEMI>
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"Fine mesh error norm := "> <RPAREN><SEMI>
        <K_PRINT_DOUBLE><LPAREN> <IDENTIFIER,enorm> <RPAREN><SEMI>
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"\n"> <RPAREN><SEMI>

                        <IDENTIFIER,residuals><LPAREN> <IDENTIFIER,fm><COMMA> <IDENTIFIER,fm1><COMMA> <IDENTIFIER,frhs><COMMA> <IDENTIFIER,fm1><COMMA> <IDENTIFIER,fres><COMMA> <IDENTIFIER,fm1> <RPAREN><SEMI>
        <IDENTIFIER,print_vector><LPAREN> <SCONSTANT,"Residuals on fine mesh"><COMMA> <IDENTIFIER,fres><COMMA> <IDENTIFIER,fm1> <RPAREN><SEMI>
        <K_IF> <LPAREN> <IDENTIFIER,interpolate><LPAREN> <IDENTIFIER,fres><COMMA> <IDENTIFIER,fm1><COMMA> <IDENTIFIER,crhs><COMMA> <IDENTIFIER,cm1> <RPAREN> <NE> <ICONSTANT,0> <RPAREN> <K_THEN>
            <K_RETURN> <IDENTIFIER,rval> <ASSIGN> <ICONSTANT,1><SEMI>

                <IDENTIFIER,enorm> <ASSIGN> <IDENTIFIER,gauss_seidel><LPAREN> <ICONSTANT,500><COMMA> <IDENTIFIER,cm><COMMA> <IDENTIFIER,cm1><COMMA> <IDENTIFIER,crhs><COMMA> <IDENTIFIER,cm1> <RPAREN><SEMI>
        <IDENTIFIER,print_vector><LPAREN> <SCONSTANT,"coarse mesh correction"><COMMA> <IDENTIFIER,cm><COMMA> <IDENTIFIER,cm1> <RPAREN><SEMI>

                <K_IF> <LPAREN> <IDENTIFIER,interpolate><LPAREN> <IDENTIFIER,cm><COMMA> <IDENTIFIER,cm1><COMMA> <IDENTIFIER,fm><COMMA> <IDENTIFIER,fm1> <RPAREN> <GT> <ICONSTANT,0> <RPAREN> <K_THEN>
            <K_RETURN> <ICONSTANT,2><SEMI>
        <IDENTIFIER,enorm> <ASSIGN> <IDENTIFIER,error_norm><LPAREN> <IDENTIFIER,fm><COMMA> <IDENTIFIER,fm1> <RPAREN><SEMI>
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"Fine mesh error norm := "> <RPAREN><SEMI>
        <K_PRINT_DOUBLE><LPAREN> <IDENTIFIER,enorm> <RPAREN><SEMI>
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"\n"> <RPAREN><SEMI>
        <IDENTIFIER,print_vector><LPAREN> <SCONSTANT,"after interpolation to fine mesh"><COMMA> <IDENTIFIER,fm><COMMA> <IDENTIFIER,fm1> <RPAREN><SEMI>

                <IDENTIFIER,enorm> <ASSIGN> <IDENTIFIER,gauss_seidel><LPAREN> <ICONSTANT,4><COMMA> <IDENTIFIER,fm><COMMA> <IDENTIFIER,fm1><COMMA> <IDENTIFIER,frhs><COMMA> <IDENTIFIER,fm1> <RPAREN><SEMI>
        <IDENTIFIER,print_vector><LPAREN> <SCONSTANT,"after second fine mesh smoothing"><COMMA> <IDENTIFIER,fm><COMMA> <IDENTIFIER,fm1> <RPAREN><SEMI>
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"Fine mesh error norm := "> <RPAREN><SEMI>
        <K_PRINT_DOUBLE><LPAREN> <IDENTIFIER,enorm> <RPAREN><SEMI>
        <K_PRINT_STRING><LPAREN> <SCONSTANT,"\n"> <RPAREN><SEMI>

                        <K_RETURN> <IDENTIFIER,rval><SEMI>

    <RCURLY>   
<RCURLY>   <EOF>